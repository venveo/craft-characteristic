{"version":3,"file":"app.883a0156.js","sources":["../../../../../buildchain/plugin-vue:export-helper","../../../../../buildchain/src/js/store/main.ts","../../../../../buildchain/src/js/app.ts"],"sourcesContent":["\nexport default (sfc, props) => {\n  const target = sfc.__vccOpts || sfc;\n  for (const [key, val] of props) {\n    target[key] = val;\n  }\n  return target;\n}\n","import { defineStore } from 'pinia'\nimport { TemporaryId, Id, RootState, Characteristic, CharacteristicLinkBlock, CharacteristicValueValue } from '@/js/types/characteristics';\n\nexport const useMainStore = defineStore('main', {\n    state: () => ({\n        characteristics: [],\n        blocks: [],\n        fieldName: ''\n    } as RootState),\n    getters: {\n        unusedCharacteristics: (state) => {\n            const activeCharacteristicIds = state.blocks.map((linkBlock) => linkBlock.characteristicId);\n            return state.characteristics.filter(characteristic => {\n                return !activeCharacteristicIds.includes(characteristic.id)\n            })\n        },\n        getCharacteristicById: (state) => {\n            return (characteristicId: Id|TemporaryId) => state.characteristics.find((characteristic) => characteristic.id === characteristicId)\n        }\n    },\n    actions: {\n        findCharacteristicIndexById(id: Id|TemporaryId) {\n            return this.characteristics.findIndex((item) => item.id === id);\n        },\n\n        findBlockIndexById(id: Id|TemporaryId) {\n            return this.blocks.findIndex((item) => item.id === id);\n        },\n\n        addBlock(block: CharacteristicLinkBlock) {\n            if (block.id === null) {\n                block.id = 'new' + block.characteristicId\n            }\n            this.blocks.push(block)\n        },\n\n        deleteBlockById(id: Id|TemporaryId) {\n            const index = this.findBlockIndexById(id);\n            if (index === -1) return;\n            this.blocks.splice(index, 1);\n        },\n\n        updateBlock(blockId: Id|TemporaryId, payload: CharacteristicLinkBlock) {\n            if (!blockId || !payload) return;\n\n            const index = this.findBlockIndexById(blockId);\n\n            if (index !== -1) {\n                this.blocks[index] = payload;\n            }\n        },\n\n        updateBlockValue(blockId: Id|TemporaryId, value: CharacteristicValueValue) {\n            const blockIndex = this.findBlockIndexById(blockId)\n            const block = Object.assign({}, this.blocks[blockIndex], {values: value})\n            this.updateBlock(blockId, block)\n        }\n    },\n})","/* global Craft */\n/* global Garnish */\nimport {createApp} from 'vue'\n\nimport App from '@/vue/App.vue'\nimport '@/css/app.pcss';\nimport {useMainStore} from \"@/js/store/main\";\nimport { createPinia } from 'pinia'\nimport { FieldSettings } from '@/js/types/characteristics';\n\n\n// @ts-ignore\nCraft.CharacteristicsField = Garnish.Base.extend({\n        init: function (settings: FieldSettings) {\n            // @ts-ignore\n            this.setSettings(settings, Craft.CharacteristicsField.defaults);\n            const props = this.settings;\n            const app = createApp(App)\n            app.use(createPinia())\n\n            const store = useMainStore();\n            store.$state = {\n                characteristics: props.characteristics,\n                blocks: props.blocks,\n                fieldName: props.name\n            }\n\n            app.mount(this.settings.mountPoint)\n            document.querySelector(this.settings.defaultsContainer).remove();\n        }\n    },\n    {\n        defaults: {\n            mountPoint: null,\n            defaultsContainer: null,\n            name: null,\n            blocks: []\n        }\n    });\n"],"names":[],"mappings":"uLACA,MAAe,CAAC,EAAK,IAAU,CAC7B,KAAM,GAAS,EAAI,WAAa,EAChC,SAAW,CAAC,EAAK,IAAQ,GACvB,EAAO,GAAO,EAEhB,MAAO,k3BCHI,GAAe,EAAY,OAAQ,CAC5C,MAAO,MACH,gBAAiB,GACjB,OAAQ,GACR,UAAW,KAEf,QAAS,CACL,sBAAuB,AAAC,GAAU,MACxB,GAA0B,EAAM,OAAO,IAAI,AAAC,GAAc,EAAU,wBACnE,GAAM,gBAAgB,OAAO,GACzB,CAAC,EAAwB,SAAS,EAAe,MAGhE,sBAAuB,AAAC,GACb,AAAC,GAAqC,EAAM,gBAAgB,KAAK,AAAC,GAAmB,EAAe,KAAO,IAG1H,QAAS,CACL,4BAA4B,EAAoB,OACrC,MAAK,gBAAgB,UAAU,AAAC,GAAS,EAAK,KAAO,IAGhE,mBAAmB,EAAoB,OAC5B,MAAK,OAAO,UAAU,AAAC,GAAS,EAAK,KAAO,IAGvD,SAAS,EAAgC,CACjC,EAAM,KAAO,SACP,GAAK,MAAQ,EAAM,uBAExB,OAAO,KAAK,IAGrB,gBAAgB,EAAoB,MAC1B,GAAQ,KAAK,mBAAmB,GAClC,IAAU,SACT,OAAO,OAAO,EAAO,IAG9B,YAAY,EAAyB,EAAkC,IAC/D,CAAC,GAAW,CAAC,cAEX,GAAQ,KAAK,mBAAmB,GAElC,IAAU,UACL,OAAO,GAAS,IAI7B,iBAAiB,EAAyB,EAAiC,MACjE,GAAa,KAAK,mBAAmB,GACrC,EAAQ,OAAO,OAAO,GAAI,KAAK,OAAO,GAAa,CAAC,OAAQ,SAC7D,YAAY,EAAS,0rFC3CtC,MAAM,qBAAuB,QAAQ,KAAK,OAAO,CACzC,KAAM,SAAU,EAAyB,MAEhC,YAAY,EAAU,MAAM,qBAAqB,eAChD,GAAQ,KAAK,SACb,EAAM,EAAU,KAClB,IAAI,UAEF,GAAQ,MACR,OAAS,CACX,gBAAiB,EAAM,gBACvB,OAAQ,EAAM,OACd,UAAW,EAAM,QAGjB,MAAM,KAAK,SAAS,qBACf,cAAc,KAAK,SAAS,mBAAmB,WAGhE,CACI,SAAU,CACN,WAAY,KACZ,kBAAmB,KACnB,KAAM,KACN,OAAQ"}